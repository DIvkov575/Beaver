[2025-04-25T01:35:04.778260000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T01:35:07.054108000Z INFO cli::lib::bq] creating bq...
[2025-04-25T01:35:09.900092000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_fpjn' successfully created.\n"
[2025-04-25T01:35:12.555497000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_fpjn.table1' successfully created.\n"
[2025-04-25T01:35:12.555568000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T01:35:15.614412000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_d7ssaae08].\n"
[2025-04-25T01:35:15.614449000Z INFO cli::lib::pubsub] ""
[2025-04-25T01:35:18.486345000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_l2a4d5iig].\n"
[2025-04-25T01:35:18.486421000Z INFO cli::lib::pubsub] ""
[2025-04-25T01:35:21.289702000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_1vaahwcih].\n"
[2025-04-25T01:35:21.289788000Z INFO cli::lib::pubsub] ""
[2025-04-25T01:35:21.289813000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T01:35:22.908358000Z ERROR cli::lib::gcs] "Creating gs://beaver_zbz77ac7j/...\n"
[2025-04-25T01:35:22.908394000Z INFO cli::lib::gcs] ""
[2025-04-25T01:35:22.908410000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:11
[2025-04-25T01:35:22.908420000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T01:35:28.554093000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_zbz77ac7j/staging/beamapp-dmitriyivkov-0425013526-365701-qbhb85n1.1745544926.365839/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_zbz77ac7j/staging/beamapp-dmitriyivkov-0425013526-365701-qbhb85n1.1745544926.365839/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_zbz77ac7j/staging/beamapp-dmitriyivkov-0425013526-365701-qbhb85n1.1745544926.365839/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_zbz77ac7j/staging/beamapp-dmitriyivkov-0425013526-365701-qbhb85n1.1745544926.365839/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_zbz77ac7j/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_zbz77ac7j/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_zbz77ac7j/templates/beaver-detection-template

[2025-04-25T01:35:28.554197000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T01:35:29.400514000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T17:48:36.813954000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T17:48:38.265563000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T17:48:38.484143000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T17:48:38.484238000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T17:48:38.489953000Z INFO cli::lib::bq] creating bq...
[2025-04-25T17:48:40.596435000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_xnhu' successfully created.\n"
[2025-04-25T17:48:42.171489000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_xnhu.table1' successfully created.\n"
[2025-04-25T17:48:42.171518000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T17:48:44.880006000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_wi4mu91js].\n"
[2025-04-25T17:48:44.880046000Z INFO cli::lib::pubsub] ""
[2025-04-25T17:48:47.432418000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_mjx8cnvas].\n"
[2025-04-25T17:48:47.432446000Z INFO cli::lib::pubsub] ""
[2025-04-25T17:48:49.784613000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_kizqwcnzb].\n"
[2025-04-25T17:48:49.784647000Z INFO cli::lib::pubsub] ""
[2025-04-25T17:48:49.784655000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T17:48:51.322833000Z ERROR cli::lib::gcs] "Creating gs://beaver_sojafzsei/...\n"
[2025-04-25T17:48:51.322865000Z INFO cli::lib::gcs] ""
[2025-04-25T17:48:51.322874000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T17:48:51.324919000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T17:49:13.565412000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 2.9 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745603332.990331-dc4484e932384ad39e70f68613874d1e.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/4caca4b9-f430-40a8-bd9c-392d204d0576].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/4caca4b9-f430-40a8-bd9c-392d204d0576?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T17:49:13.565455000Z INFO cli::lib::cloud_build] "------------------------------------------------------------------- REMOTE BUILD OUTPUT -------------------------------------------------------------------\nstarting build \"4caca4b9-f430-40a8-bd9c-392d204d0576\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745603332.990331-dc4484e932384ad39e70f68613874d1e.tgz#1745603333450782\nCopying gs://neon-circle-400322_cloudbuild/source/1745603332.990331-dc4484e932384ad39e70f68613874d1e.tgz#1745603333450782...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 24ebb750d0ce\nRemoving intermediate container 24ebb750d0ce\n ---> 1f07d126c977\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 267accbfdcf3\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 4c17034c9ae2\nRemoving intermediate container 4c17034c9ae2\n ---> 2495e01cdcea\nSuccessfully built 2495e01cdcea\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-goofjlh:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-goofjlh\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-goofjlh]\nd771a5927798: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n12979aa71141: Layer already exists\ncfe369838527: Layer already exists\n310062f15e93: Layer already exists\n5f70bf18a086: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\nd771a5927798: Pushed\nlatest: digest: sha256:993f1155be768ce79c9e1e113d1a12c2bef4b9ecf587d705ef401e0127ae2e0d size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n4caca4b9-f430-40a8-bd9c-392d204d0576  2025-04-25T17:48:53+00:00  17S       gs://neon-circle-400322_cloudbuild/source/1745603332.990331-dc4484e932384ad39e70f68613874d1e.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-goofjlh (+1 more)  SUCCESS\n"
[2025-04-25T17:49:13.565485000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T17:49:13.565490000Z INFO cli::lib::crs] creating vector...
[2025-04-25T17:49:23.610365000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-kkdz\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision................................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-kkdz\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-kkdz-00001-xwq\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-kkdz-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T17:49:23.610416000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T17:49:24.239764000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T17:49:24.239850000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:12
[2025-04-25T17:49:24.239879000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T17:49:28.529622000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_sojafzsei/staging/beamapp-dmitriyivkov-0425174926-347392-f2xvz2oo.1745603366.347496/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_sojafzsei/staging/beamapp-dmitriyivkov-0425174926-347392-f2xvz2oo.1745603366.347496/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_sojafzsei/staging/beamapp-dmitriyivkov-0425174926-347392-f2xvz2oo.1745603366.347496/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_sojafzsei/staging/beamapp-dmitriyivkov-0425174926-347392-f2xvz2oo.1745603366.347496/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_sojafzsei/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_sojafzsei/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_sojafzsei/templates/beaver-detection-template

[2025-04-25T17:49:28.529658000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:59
[2025-04-25T17:49:28.529664000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T17:49:28.945915000Z ERROR cli::lib::utilities] "ERROR: (gcloud.dataflow.jobs.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T17:49:28.945943000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T19:45:15.256634000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T19:45:17.305560000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T19:45:17.612347000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T19:45:17.612439000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T19:45:17.619472000Z INFO cli::lib::bq] creating bq...
[2025-04-25T19:45:20.198326000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_p9hg' successfully created.\n"
[2025-04-25T19:45:22.538146000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_p9hg.table1' successfully created.\n"
[2025-04-25T19:45:22.538178000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T19:45:22.538186000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T19:45:25.501465000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_mudymbwpi].\n"
[2025-04-25T19:45:25.501499000Z INFO cli::lib::pubsub] ""
[2025-04-25T19:45:25.501506000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T19:45:28.754820000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_mm9iss12j].\n"
[2025-04-25T19:45:28.754873000Z INFO cli::lib::pubsub] ""
[2025-04-25T19:45:28.754883000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T19:45:31.064101000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_j7ljmqbd6].\n"
[2025-04-25T19:45:31.064140000Z INFO cli::lib::pubsub] ""
[2025-04-25T19:45:31.064149000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T19:45:32.745466000Z ERROR cli::lib::gcs] "Creating gs://beaver_lfeut59e2/...\n"
[2025-04-25T19:45:32.745503000Z INFO cli::lib::gcs] ""
[2025-04-25T19:45:32.745514000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T19:45:32.746690000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T19:45:55.952336000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 2.9 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745610334.467843-80866660d0284dd7904e78653afd79ed.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/fd09dd2e-daa9-46fd-a4c7-50e722bc1d66].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/fd09dd2e-daa9-46fd-a4c7-50e722bc1d66?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T19:45:55.952399000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"fd09dd2e-daa9-46fd-a4c7-50e722bc1d66\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745610334.467843-80866660d0284dd7904e78653afd79ed.tgz#1745610335990665\nCopying gs://neon-circle-400322_cloudbuild/source/1745610334.467843-80866660d0284dd7904e78653afd79ed.tgz#1745610335990665...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\nf7c2963674a5: Download complete\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Pull complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 14853425b236\nRemoving intermediate container 14853425b236\n ---> 5eeab531f146\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 0edf894dd6aa\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in a8f6ecf8fc49\nRemoving intermediate container a8f6ecf8fc49\n ---> 22e7b97d4273\nSuccessfully built 22e7b97d4273\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vpyfb9p:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vpyfb9p\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vpyfb9p]\n76ff34421209: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n12979aa71141: Layer already exists\n310062f15e93: Layer already exists\n5f70bf18a086: Layer already exists\ncfe369838527: Layer already exists\n08000c18d16d: Layer already exists\n59a81ac6038d: Layer already exists\n76ff34421209: Pushed\nlatest: digest: sha256:1f23a74155a0ba929f33170a01e483e424f10db053d5d5b02ab5887bbe9a0891 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\nfd09dd2e-daa9-46fd-a4c7-50e722bc1d66  2025-04-25T19:45:36+00:00  16S       gs://neon-circle-400322_cloudbuild/source/1745610334.467843-80866660d0284dd7904e78653afd79ed.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vpyfb9p (+1 more)  SUCCESS\n"
[2025-04-25T19:45:55.952458000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T19:45:55.952469000Z INFO cli::lib::crs] creating vector...
[2025-04-25T19:46:06.349648000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-ywpw\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision...................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-ywpw\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-ywpw-00001-ftx\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-ywpw-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T19:46:06.349734000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T19:46:08.728775000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T19:46:08.728866000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:12
[2025-04-25T19:46:08.728893000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T19:46:16.591397000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_lfeut59e2/staging/beamapp-dmitriyivkov-0425194614-059080-r4ks18ob.1745610374.059265/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_lfeut59e2/staging/beamapp-dmitriyivkov-0425194614-059080-r4ks18ob.1745610374.059265/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_lfeut59e2/staging/beamapp-dmitriyivkov-0425194614-059080-r4ks18ob.1745610374.059265/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_lfeut59e2/staging/beamapp-dmitriyivkov-0425194614-059080-r4ks18ob.1745610374.059265/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_lfeut59e2/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_lfeut59e2/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_lfeut59e2/templates/beaver-detection-template

[2025-04-25T19:46:16.591438000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:59
[2025-04-25T19:46:16.591446000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T19:46:16.994456000Z ERROR cli::lib::utilities] "ERROR: (gcloud.dataflow.jobs.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T19:46:16.994484000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T20:21:57.262777000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:21:58.846353000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:21:59.079173000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:21:59.079259000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:21:59.085303000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:22:01.292621000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_tqwm' successfully created.\n"
[2025-04-25T20:22:02.902747000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_tqwm.table1' successfully created.\n"
[2025-04-25T20:22:02.902779000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:22:02.902785000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:22:05.563874000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_lubwsdghr].\n"
[2025-04-25T20:22:05.563910000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:22:05.563918000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:22:07.889144000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_7cggnz4wj].\n"
[2025-04-25T20:22:07.889179000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:22:07.889187000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:22:10.038233000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_zobu95jzm].\n"
[2025-04-25T20:22:10.038280000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:22:10.038289000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:22:11.233102000Z ERROR cli::lib::gcs] "Creating gs://beaver_nl0vrqdcp/...\n"
[2025-04-25T20:22:11.233132000Z INFO cli::lib::gcs] ""
[2025-04-25T20:22:11.233146000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:22:11.233980000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:22:35.383724000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745612532.267053-eb4d079e98ae4fbf845b867a66f0b38e.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/7b888953-4968-4278-940c-ea3918d6133f].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/7b888953-4968-4278-940c-ea3918d6133f?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:22:35.383768000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"7b888953-4968-4278-940c-ea3918d6133f\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745612532.267053-eb4d079e98ae4fbf845b867a66f0b38e.tgz#1745612532901261\nCopying gs://neon-circle-400322_cloudbuild/source/1745612532.267053-eb4d079e98ae4fbf845b867a66f0b38e.tgz#1745612532901261...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 5dffd4a14119\nRemoving intermediate container 5dffd4a14119\n ---> 700272a8b571\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 4677291a1167\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 758bafab9866\nRemoving intermediate container 758bafab9866\n ---> 10b66d2f56d8\nSuccessfully built 10b66d2f56d8\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-7qkmxtq:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-7qkmxtq\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-7qkmxtq]\ndcc070bdddd5: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n310062f15e93: Layer already exists\n5f70bf18a086: Layer already exists\n12979aa71141: Layer already exists\ncfe369838527: Layer already exists\n08000c18d16d: Layer already exists\n59a81ac6038d: Layer already exists\ndcc070bdddd5: Pushed\nlatest: digest: sha256:e17746b4bfa93e8510e5b0dd62087e2d4ee658c8e6a510f2756c20bd8d631d83 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n7b888953-4968-4278-940c-ea3918d6133f  2025-04-25T20:22:13+00:00  18S       gs://neon-circle-400322_cloudbuild/source/1745612532.267053-eb4d079e98ae4fbf845b867a66f0b38e.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-7qkmxtq (+1 more)  SUCCESS\n"
[2025-04-25T20:22:35.383799000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:22:35.383804000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:22:44.820925000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-kk9n\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision............................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-kk9n\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-kk9n-00001-99z\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-kk9n-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:22:44.820972000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:22:45.349143000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:22:45.349176000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:22:45.349182000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:22:49.467096000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_nl0vrqdcp/staging/beamapp-dmitriyivkov-0425202247-627047-1893flcm.1745612567.627154/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_nl0vrqdcp/staging/beamapp-dmitriyivkov-0425202247-627047-1893flcm.1745612567.627154/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_nl0vrqdcp/staging/beamapp-dmitriyivkov-0425202247-627047-1893flcm.1745612567.627154/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_nl0vrqdcp/staging/beamapp-dmitriyivkov-0425202247-627047-1893flcm.1745612567.627154/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_nl0vrqdcp/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_nl0vrqdcp/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_nl0vrqdcp/templates/beaver-detection-template

[2025-04-25T20:22:49.467126000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:91
[2025-04-25T20:22:49.467147000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_vf8lmzkd9...
[2025-04-25T20:22:49.996820000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments: --enable-streaming (did you mean '--enable-streaming-engine'?) \n\nTo search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:22:49.996859000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_vf8lmzkd9, retrying...
[2025-04-25T20:22:49.996876000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_xb8v2jni4...
[2025-04-25T20:22:50.660656000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments: --enable-streaming (did you mean '--enable-streaming-engine'?) \n\nTo search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:22:50.660685000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_xb8v2jni4, retrying...
[2025-04-25T20:22:50.660700000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_emcrtr1wj...
[2025-04-25T20:22:51.181360000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments: --enable-streaming (did you mean '--enable-streaming-engine'?) \n\nTo search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:22:51.181385000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_emcrtr1wj, retrying...
[2025-04-25T20:22:51.181399000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_5kqtbomnf...
[2025-04-25T20:22:51.599174000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments: --enable-streaming (did you mean '--enable-streaming-engine'?) \n\nTo search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:22:51.599205000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_5kqtbomnf, retrying...
[2025-04-25T20:22:51.599221000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_xuslkwwrr...
[2025-04-25T20:22:52.034935000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments: --enable-streaming (did you mean '--enable-streaming-engine'?) \n\nTo search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:22:52.034962000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_xuslkwwrr, retrying...
[2025-04-25T20:33:32.738202000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:33:33.849962000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:33:34.043745000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:33:34.043844000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:33:34.049399000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:33:35.801975000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_tl9p' successfully created.\n"
[2025-04-25T20:33:37.400660000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_tl9p.table1' successfully created.\n"
[2025-04-25T20:33:37.400695000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:33:37.400703000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:33:40.538936000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_nv7wiq9gd].\n"
[2025-04-25T20:33:40.538968000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:33:40.538976000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:33:42.731653000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_gkjrpvhrs].\n"
[2025-04-25T20:33:42.731689000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:33:42.731705000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:33:45.060022000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_zge94r2pi].\n"
[2025-04-25T20:33:45.060059000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:33:45.060065000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:33:46.321800000Z ERROR cli::lib::gcs] "Creating gs://beaver_higs8cvzh/...\n"
[2025-04-25T20:33:46.321827000Z INFO cli::lib::gcs] ""
[2025-04-25T20:33:46.321835000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:33:46.322474000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:34:10.415495000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613227.477105-27afc13275994ba78e6989718d3b93d3.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/990ca675-ba67-41d2-930b-e981095ea3d8].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/990ca675-ba67-41d2-930b-e981095ea3d8?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:34:10.415537000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"990ca675-ba67-41d2-930b-e981095ea3d8\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613227.477105-27afc13275994ba78e6989718d3b93d3.tgz#1745613229393709\nCopying gs://neon-circle-400322_cloudbuild/source/1745613227.477105-27afc13275994ba78e6989718d3b93d3.tgz#1745613229393709...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 4d865d8a314b\nRemoving intermediate container 4d865d8a314b\n ---> a128d4c42050\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> d34cccf3e2f8\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 3eb7d753f640\nRemoving intermediate container 3eb7d753f640\n ---> 8433726d9745\nSuccessfully built 8433726d9745\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-tser5ff:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-tser5ff\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-tser5ff]\necb6b8ef5009: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n310062f15e93: Layer already exists\n12979aa71141: Layer already exists\n5f70bf18a086: Layer already exists\ncfe369838527: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\necb6b8ef5009: Pushed\nlatest: digest: sha256:0e022e484796116756a7ecb603d0bb1118fce4ca34705aa6378dc3125437d828 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n990ca675-ba67-41d2-930b-e981095ea3d8  2025-04-25T20:33:49+00:00  15S       gs://neon-circle-400322_cloudbuild/source/1745613227.477105-27afc13275994ba78e6989718d3b93d3.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-tser5ff (+1 more)  SUCCESS\n"
[2025-04-25T20:34:10.415568000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:34:10.415572000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:34:18.288669000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-28vg\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision.............................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-28vg\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-28vg-00001-w5x\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-28vg-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:34:18.288700000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:34:18.748263000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:34:18.748293000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:34:18.748297000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:34:22.852941000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_higs8cvzh/staging/beamapp-dmitriyivkov-0425203420-530965-wutme0za.1745613260.531076/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_higs8cvzh/staging/beamapp-dmitriyivkov-0425203420-530965-wutme0za.1745613260.531076/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_higs8cvzh/staging/beamapp-dmitriyivkov-0425203420-530965-wutme0za.1745613260.531076/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_higs8cvzh/staging/beamapp-dmitriyivkov-0425203420-530965-wutme0za.1745613260.531076/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_higs8cvzh/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_higs8cvzh/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_higs8cvzh/templates/beaver-detection-template

[2025-04-25T20:34:22.852983000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:91
[2025-04-25T20:34:22.853002000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_hjpr3y67r...
[2025-04-25T20:34:23.259738000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:34:23.259768000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_hjpr3y67r, retrying...
[2025-04-25T20:34:23.259782000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_3qa3g6uyb...
[2025-04-25T20:34:23.667747000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:34:23.667779000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_3qa3g6uyb, retrying...
[2025-04-25T20:34:23.667793000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_tsd0uxavt...
[2025-04-25T20:34:24.140951000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:34:24.140989000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_tsd0uxavt, retrying...
[2025-04-25T20:34:24.141005000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_6uumwkty0...
[2025-04-25T20:34:24.710644000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:34:24.710669000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_6uumwkty0, retrying...
[2025-04-25T20:34:24.710683000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_v9opy32ka...
[2025-04-25T20:34:25.291256000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:34:25.291282000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_v9opy32ka, retrying...
[2025-04-25T20:36:05.801563000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:36:07.148454000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:36:07.288354000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:36:07.288443000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:36:07.293964000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:36:09.242292000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_5nut' successfully created.\n"
[2025-04-25T20:36:11.011870000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_5nut.table1' successfully created.\n"
[2025-04-25T20:36:11.011913000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:36:11.011920000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:36:14.166549000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_upcq9xhx6].\n"
[2025-04-25T20:36:14.166580000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:36:14.166588000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:36:17.295392000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_qzn56ach3].\n"
[2025-04-25T20:36:17.295415000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:36:17.295422000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:36:19.369565000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_5kwmpdqrn].\n"
[2025-04-25T20:36:19.369596000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:36:19.369605000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:36:20.573748000Z ERROR cli::lib::gcs] "Creating gs://beaver_vqbi1velt/...\n"
[2025-04-25T20:36:20.573781000Z INFO cli::lib::gcs] ""
[2025-04-25T20:36:20.573789000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:36:20.574377000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:36:48.212594000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613381.766612-fcede78c6cc948be97657a82e620a17e.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/8069ed44-749f-42b6-9a96-2cc532074d54].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/8069ed44-749f-42b6-9a96-2cc532074d54?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:36:48.212643000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"8069ed44-749f-42b6-9a96-2cc532074d54\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613381.766612-fcede78c6cc948be97657a82e620a17e.tgz#1745613382299844\nCopying gs://neon-circle-400322_cloudbuild/source/1745613381.766612-fcede78c6cc948be97657a82e620a17e.tgz#1745613382299844...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Pull complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 75f731a8ee2d\nRemoving intermediate container 75f731a8ee2d\n ---> 8cf9a16ce8f7\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 344e80b8f068\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in a58357c08b3d\nRemoving intermediate container a58357c08b3d\n ---> c5712dd8d5a5\nSuccessfully built c5712dd8d5a5\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ln4o5hs:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ln4o5hs\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ln4o5hs]\n731a0d5a8538: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n12979aa71141: Layer already exists\n5f70bf18a086: Layer already exists\n310062f15e93: Layer already exists\ncfe369838527: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\n731a0d5a8538: Pushed\nlatest: digest: sha256:8d063d68263a6383a11f3d11f61c045124d4dfa0f4f08031aa421b3c383c90a6 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n8069ed44-749f-42b6-9a96-2cc532074d54  2025-04-25T20:36:22+00:00  22S       gs://neon-circle-400322_cloudbuild/source/1745613381.766612-fcede78c6cc948be97657a82e620a17e.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ln4o5hs (+1 more)  SUCCESS\n"
[2025-04-25T20:36:48.212660000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:36:48.212665000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:36:57.501546000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-abto\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision...........................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-abto\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-abto-00001-79j\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-abto-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:36:57.501608000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:36:57.949881000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:36:57.949906000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:36:57.949910000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:37:02.450953000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_vqbi1velt/staging/beamapp-dmitriyivkov-0425203659-610090-rfkmsfth.1745613419.610191/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_vqbi1velt/staging/beamapp-dmitriyivkov-0425203659-610090-rfkmsfth.1745613419.610191/submission_environment_dependencies.txt in 1 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_vqbi1velt/staging/beamapp-dmitriyivkov-0425203659-610090-rfkmsfth.1745613419.610191/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_vqbi1velt/staging/beamapp-dmitriyivkov-0425203659-610090-rfkmsfth.1745613419.610191/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_vqbi1velt/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_vqbi1velt/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_vqbi1velt/templates/beaver-detection-template

[2025-04-25T20:37:02.450992000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:91
[2025-04-25T20:37:02.451012000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_cglxzkb9h...
[2025-04-25T20:37:02.842584000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments:\n  --location (did you mean '--temp-location'?)\n  northamerica-northeast1\n  To search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:37:02.842609000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_cglxzkb9h, retrying...
[2025-04-25T20:37:02.842622000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_7nb1gszbh...
[2025-04-25T20:37:03.213564000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments:\n  --location (did you mean '--temp-location'?)\n  northamerica-northeast1\n  To search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:37:03.213585000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_7nb1gszbh, retrying...
[2025-04-25T20:37:03.213598000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_tulrcifxi...
[2025-04-25T20:37:03.587355000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments:\n  --location (did you mean '--temp-location'?)\n  northamerica-northeast1\n  To search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:37:03.587383000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_tulrcifxi, retrying...
[2025-04-25T20:37:03.587398000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_2tf9n8qsl...
[2025-04-25T20:37:03.959476000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments:\n  --location (did you mean '--temp-location'?)\n  northamerica-northeast1\n  To search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:37:03.959497000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_2tf9n8qsl, retrying...
[2025-04-25T20:37:03.959512000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_agzloyjbd...
[2025-04-25T20:37:04.332721000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) unrecognized arguments:\n  --location (did you mean '--temp-location'?)\n  northamerica-northeast1\n  To search the help text of gcloud commands, run:\n  gcloud help -- SEARCH_TERMS\n"
[2025-04-25T20:37:04.332749000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_agzloyjbd, retrying...
[2025-04-25T20:38:25.534981000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:38:26.681613000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:38:26.930744000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:38:26.930836000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:38:26.937454000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:38:29.165082000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_uqpj' successfully created.\n"
[2025-04-25T20:38:31.558545000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_uqpj.table1' successfully created.\n"
[2025-04-25T20:38:31.558577000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:38:31.558583000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:38:34.653716000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_1k4nrdvje].\n"
[2025-04-25T20:38:34.653752000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:38:34.653760000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:38:37.706340000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_np5jqq1ph].\n"
[2025-04-25T20:38:37.706392000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:38:37.706401000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:38:39.953071000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_pv4pf35b2].\n"
[2025-04-25T20:38:39.953110000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:38:39.953118000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:38:41.180097000Z ERROR cli::lib::gcs] "Creating gs://beaver_wjizkc5sw/...\n"
[2025-04-25T20:38:41.180145000Z INFO cli::lib::gcs] ""
[2025-04-25T20:38:41.180159000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:38:41.180979000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:39:08.387020000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613522.165989-94becf5f4c26488d980ea660e1277d32.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/7cd7c6cf-3e7b-4fdc-bd88-f03922df6bdb].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/7cd7c6cf-3e7b-4fdc-bd88-f03922df6bdb?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:39:08.387060000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"7cd7c6cf-3e7b-4fdc-bd88-f03922df6bdb\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613522.165989-94becf5f4c26488d980ea660e1277d32.tgz#1745613522752060\nCopying gs://neon-circle-400322_cloudbuild/source/1745613522.165989-94becf5f4c26488d980ea660e1277d32.tgz#1745613522752060...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\nf7c2963674a5: Pull complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 9ddfefb3647f\nRemoving intermediate container 9ddfefb3647f\n ---> d2c4bcfe3e71\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 89d9509c259d\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 21a1e19d4526\nRemoving intermediate container 21a1e19d4526\n ---> d7058420a22b\nSuccessfully built d7058420a22b\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-hkyl7jj:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-hkyl7jj\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-hkyl7jj]\ndbe0c9b895bc: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n310062f15e93: Layer already exists\n5f70bf18a086: Layer already exists\n12979aa71141: Layer already exists\ncfe369838527: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\ndbe0c9b895bc: Pushed\nlatest: digest: sha256:d3be49d734b215be224d426b586e74dca0fc0e22fcd6d97795878c8e30cf60d3 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n7cd7c6cf-3e7b-4fdc-bd88-f03922df6bdb  2025-04-25T20:38:42+00:00  21S       gs://neon-circle-400322_cloudbuild/source/1745613522.165989-94becf5f4c26488d980ea660e1277d32.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-hkyl7jj (+1 more)  SUCCESS\n"
[2025-04-25T20:39:08.387080000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:39:08.387086000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:39:17.993488000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-lsqu\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision...........................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-lsqu\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-lsqu-00001-4vc\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-lsqu-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:39:17.993532000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:39:18.454342000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:39:18.454372000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:39:18.454378000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:39:22.693917000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_wjizkc5sw/staging/beamapp-dmitriyivkov-0425203920-332877-jilqw1j3.1745613560.332993/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_wjizkc5sw/staging/beamapp-dmitriyivkov-0425203920-332877-jilqw1j3.1745613560.332993/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_wjizkc5sw/staging/beamapp-dmitriyivkov-0425203920-332877-jilqw1j3.1745613560.332993/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_wjizkc5sw/staging/beamapp-dmitriyivkov-0425203920-332877-jilqw1j3.1745613560.332993/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_wjizkc5sw/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_wjizkc5sw/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_wjizkc5sw/templates/beaver-detection-template

[2025-04-25T20:39:22.693955000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:91
[2025-04-25T20:39:22.693971000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_kdhgaf0zw...
[2025-04-25T20:39:23.746981000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: JobName invalid; the name must consist of only the characters [-a-z0-9], starting with a letter and ending with a letter or number\n"
[2025-04-25T20:39:23.747021000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_kdhgaf0zw, retrying...
[2025-04-25T20:39:23.747040000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_aapdzikcn...
[2025-04-25T20:39:24.547492000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: JobName invalid; the name must consist of only the characters [-a-z0-9], starting with a letter and ending with a letter or number\n"
[2025-04-25T20:39:24.547521000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_aapdzikcn, retrying...
[2025-04-25T20:39:24.547536000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver_detections_l6w08jix8...
[2025-04-25T20:39:25.353542000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: JobName invalid; the name must consist of only the characters [-a-z0-9], starting with a letter and ending with a letter or number\n"
[2025-04-25T20:39:25.353574000Z WARN cli::lib::dataflow] Failed to create pipeline beaver_detections_l6w08jix8, retrying...
[2025-04-25T20:40:04.471429000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:40:05.491652000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:40:05.631965000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:40:05.632048000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:40:05.637466000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:40:07.397767000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_u1z8' successfully created.\n"
[2025-04-25T20:40:09.363275000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_u1z8.table1' successfully created.\n"
[2025-04-25T20:40:09.363324000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:40:09.363332000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:40:14.580611000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_ayusdwr6p].\n"
[2025-04-25T20:40:14.580653000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:40:14.580661000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:40:17.297083000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_lgn1vp1jh].\n"
[2025-04-25T20:40:17.297116000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:40:17.297124000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:40:19.683691000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_zgnjp3iig].\n"
[2025-04-25T20:40:19.683723000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:40:19.683730000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:40:21.124800000Z ERROR cli::lib::gcs] "Creating gs://beaver_4n3lwmcui/...\n"
[2025-04-25T20:40:21.124843000Z INFO cli::lib::gcs] ""
[2025-04-25T20:40:21.124859000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:40:21.125597000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:40:49.457556000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613622.255003-eb312e5dd4294017b9de8f1e77fa0f43.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/690218ad-ad5a-443d-802f-786e6f94c589].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/690218ad-ad5a-443d-802f-786e6f94c589?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:40:49.457593000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"690218ad-ad5a-443d-802f-786e6f94c589\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613622.255003-eb312e5dd4294017b9de8f1e77fa0f43.tgz#1745613622894097\nCopying gs://neon-circle-400322_cloudbuild/source/1745613622.255003-eb312e5dd4294017b9de8f1e77fa0f43.tgz#1745613622894097...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Pull complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 35cb14cffd41\nRemoving intermediate container 35cb14cffd41\n ---> 7e44f58998c9\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 7f6fcd464bf2\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 15a7ab7ec9fd\nRemoving intermediate container 15a7ab7ec9fd\n ---> 94ca8cf2435d\nSuccessfully built 94ca8cf2435d\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-q03hwuw:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-q03hwuw\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-q03hwuw]\ne313243b330f: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n5f70bf18a086: Layer already exists\n310062f15e93: Layer already exists\n12979aa71141: Layer already exists\ncfe369838527: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\ne313243b330f: Pushed\nlatest: digest: sha256:af5b89bbb159e07e0668367677ac1fcdfa5db4f2713be187d593da992c75053e size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n690218ad-ad5a-443d-802f-786e6f94c589  2025-04-25T20:40:23+00:00  23S       gs://neon-circle-400322_cloudbuild/source/1745613622.255003-eb312e5dd4294017b9de8f1e77fa0f43.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-q03hwuw (+1 more)  SUCCESS\n"
[2025-04-25T20:40:49.457612000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:40:49.457618000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:40:58.618574000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-tomc\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision.........................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-tomc\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-tomc-00001-kvt\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-tomc-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:40:58.618627000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:40:59.054465000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:40:59.054499000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:40:59.054506000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:41:03.251623000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_4n3lwmcui/staging/beamapp-dmitriyivkov-0425204100-715960-mhpabttk.1745613660.716062/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_4n3lwmcui/staging/beamapp-dmitriyivkov-0425204100-715960-mhpabttk.1745613660.716062/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_4n3lwmcui/staging/beamapp-dmitriyivkov-0425204100-715960-mhpabttk.1745613660.716062/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_4n3lwmcui/staging/beamapp-dmitriyivkov-0425204100-715960-mhpabttk.1745613660.716062/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_4n3lwmcui/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_4n3lwmcui/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_4n3lwmcui/templates/beaver-detection-template

[2025-04-25T20:41:03.251659000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:91
[2025-04-25T20:41:03.251677000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver-detections-jo4u8ip4m...
[2025-04-25T20:41:03.892252000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: (66268328fd46b130): Docker image not specified in the template file.\n"
[2025-04-25T20:41:03.892287000Z WARN cli::lib::dataflow] Failed to create pipeline beaver-detections-jo4u8ip4m, retrying...
[2025-04-25T20:41:03.892309000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver-detections-oe2xx5dh4...
[2025-04-25T20:41:04.513188000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: (96dd4cb24cdba981): Docker image not specified in the template file.\n"
[2025-04-25T20:41:04.513219000Z WARN cli::lib::dataflow] Failed to create pipeline beaver-detections-oe2xx5dh4, retrying...
[2025-04-25T20:41:04.513236000Z INFO cli::lib::dataflow] Creating and running dataflow pipeline: beaver-detections-4pzg1zxr8...
[2025-04-25T20:41:05.094592000Z ERROR cli::lib::dataflow] "ERROR: (gcloud.dataflow.flex-template.run) INVALID_ARGUMENT: (a412d348d6b6bef9): Docker image not specified in the template file.\n"
[2025-04-25T20:41:05.094628000Z WARN cli::lib::dataflow] Failed to create pipeline beaver-detections-4pzg1zxr8, retrying...
[2025-04-25T20:42:05.761463000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:42:06.873723000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:42:07.009852000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:42:07.009945000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:42:07.015729000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:42:09.150089000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_il8c' successfully created.\n"
[2025-04-25T20:42:11.382597000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_il8c.table1' successfully created.\n"
[2025-04-25T20:42:11.382629000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:42:11.382635000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:42:15.002548000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_uc3f98wg6].\n"
[2025-04-25T20:42:15.002587000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:42:15.002595000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:42:18.797156000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_uhweps3bk].\n"
[2025-04-25T20:42:18.797192000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:42:18.797200000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:42:21.247655000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_0hczzw3jw].\n"
[2025-04-25T20:42:21.247698000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:42:21.247707000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:42:22.240336000Z ERROR cli::lib::gcs] "Creating gs://beaver_d8rhzkgqf/...\n"
[2025-04-25T20:42:22.240382000Z INFO cli::lib::gcs] ""
[2025-04-25T20:42:22.240393000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:42:22.241093000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:42:44.226500000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613743.216046-2ee7ccb711da45a49bc71f16072f14b8.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/78e0cfbe-5d38-48ee-a852-c20bde65d943].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/78e0cfbe-5d38-48ee-a852-c20bde65d943?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:42:44.226543000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"78e0cfbe-5d38-48ee-a852-c20bde65d943\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613743.216046-2ee7ccb711da45a49bc71f16072f14b8.tgz#1745613743914412\nCopying gs://neon-circle-400322_cloudbuild/source/1745613743.216046-2ee7ccb711da45a49bc71f16072f14b8.tgz#1745613743914412...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 967f59add336\nRemoving intermediate container 967f59add336\n ---> 44b7ae3826b9\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> c850a8aa951b\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 676916f2f579\nRemoving intermediate container 676916f2f579\n ---> 009f07e0df51\nSuccessfully built 009f07e0df51\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vp0skvu:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vp0skvu\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vp0skvu]\ncaf0af21febb: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n5f70bf18a086: Layer already exists\ncfe369838527: Layer already exists\n12979aa71141: Layer already exists\n310062f15e93: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\ncaf0af21febb: Pushed\nlatest: digest: sha256:b18b9db4c4f2e2bc3fc53bd4db81eacf5a97d497b6d4bd5597aed4787ecffb4e size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n78e0cfbe-5d38-48ee-a852-c20bde65d943  2025-04-25T20:42:24+00:00  16S       gs://neon-circle-400322_cloudbuild/source/1745613743.216046-2ee7ccb711da45a49bc71f16072f14b8.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-vp0skvu (+1 more)  SUCCESS\n"
[2025-04-25T20:42:44.226562000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:42:44.226568000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:42:53.741529000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-aofo\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision...........................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-aofo\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-aofo-00001-dw2\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-aofo-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:42:53.741578000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:42:54.195605000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:42:54.195637000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:42:54.195643000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:42:58.272498000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_d8rhzkgqf/staging/beamapp-dmitriyivkov-0425204256-018672-e63by4d6.1745613776.018779/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_d8rhzkgqf/staging/beamapp-dmitriyivkov-0425204256-018672-e63by4d6.1745613776.018779/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_d8rhzkgqf/staging/beamapp-dmitriyivkov-0425204256-018672-e63by4d6.1745613776.018779/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_d8rhzkgqf/staging/beamapp-dmitriyivkov-0425204256-018672-e63by4d6.1745613776.018779/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_d8rhzkgqf/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_d8rhzkgqf/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_d8rhzkgqf/templates/beaver-detection-template

[2025-04-25T20:42:58.272540000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T20:45:09.512387000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:45:10.528962000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:45:10.669764000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:45:10.669861000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:45:10.675413000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:45:12.809359000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_bgqe' successfully created.\n"
[2025-04-25T20:45:14.430465000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_bgqe.table1' successfully created.\n"
[2025-04-25T20:45:14.430503000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:45:14.430510000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:45:17.822192000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_7stkpkuif].\n"
[2025-04-25T20:45:17.822226000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:45:17.822234000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:45:20.466772000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_iyqfkpf2j].\n"
[2025-04-25T20:45:20.466815000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:45:20.466824000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:45:23.337832000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_7n9oljljr].\n"
[2025-04-25T20:45:23.337863000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:45:23.337871000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:45:24.473067000Z ERROR cli::lib::gcs] "Creating gs://beaver_e9slgrkev/...\n"
[2025-04-25T20:45:24.473116000Z INFO cli::lib::gcs] ""
[2025-04-25T20:45:24.473135000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:45:24.473871000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:45:46.895719000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745613925.607158-937a50849ef544038f55fc697b1119f4.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/067ae099-d91b-4706-9c97-6057460f02fa].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/067ae099-d91b-4706-9c97-6057460f02fa?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:45:46.895752000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"067ae099-d91b-4706-9c97-6057460f02fa\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745613925.607158-937a50849ef544038f55fc697b1119f4.tgz#1745613926237497\nCopying gs://neon-circle-400322_cloudbuild/source/1745613925.607158-937a50849ef544038f55fc697b1119f4.tgz#1745613926237497...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 3c6cda4d5f5a\nRemoving intermediate container 3c6cda4d5f5a\n ---> b6d821edb5d1\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 0c4f8b6e57cd\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in f50f62f8b301\nRemoving intermediate container f50f62f8b301\n ---> 33d976738d91\nSuccessfully built 33d976738d91\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-cefqoj1:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-cefqoj1\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-cefqoj1]\na89bcb512e99: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\ncfe369838527: Layer already exists\n12979aa71141: Layer already exists\n5f70bf18a086: Layer already exists\n310062f15e93: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\na89bcb512e99: Pushed\nlatest: digest: sha256:a1f20e553730cc9217696191c6f3616e41ee953594b8d220161e43881a0994f5 size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n067ae099-d91b-4706-9c97-6057460f02fa  2025-04-25T20:45:26+00:00  16S       gs://neon-circle-400322_cloudbuild/source/1745613925.607158-937a50849ef544038f55fc697b1119f4.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-cefqoj1 (+1 more)  SUCCESS\n"
[2025-04-25T20:45:46.895775000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:45:46.895781000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:45:58.936752000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-0htr\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision...................................................................................................done\nRouting traffic......done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-0htr\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-0htr-00001-6rv\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-0htr-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:45:58.936803000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:45:59.387661000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:45:59.387692000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:45:59.387698000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:46:03.484038000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_e9slgrkev/staging/beamapp-dmitriyivkov-0425204601-126316-cgy7l233.1745613961.126426/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_e9slgrkev/staging/beamapp-dmitriyivkov-0425204601-126316-cgy7l233.1745613961.126426/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_e9slgrkev/staging/beamapp-dmitriyivkov-0425204601-126316-cgy7l233.1745613961.126426/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_e9slgrkev/staging/beamapp-dmitriyivkov-0425204601-126316-cgy7l233.1745613961.126426/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_e9slgrkev/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_e9slgrkev/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_e9slgrkev/templates/beaver-detection-template

[2025-04-25T20:46:03.484076000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:61
[2025-04-25T20:46:03.484084000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T20:46:03.862676000Z ERROR cli::lib::utilities] "ERROR: (gcloud.dataflow.jobs.run) The required property [project] is not currently set.\nIt can be set on a per-command basis by re-running your command with the [--project] flag.\n\nYou may set it for your current workspace by running:\n\n  $ gcloud config set project VALUE\n\nor it can be set temporarily by the environment variable [CLOUDSDK_CORE_PROJECT]\n"
[2025-04-25T20:46:03.862706000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T20:50:41.901534000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T20:50:43.377037000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T20:50:43.620179000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T20:50:43.620280000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T20:50:43.626995000Z INFO cli::lib::bq] creating bq...
[2025-04-25T20:50:46.183860000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_fwj1' successfully created.\n"
[2025-04-25T20:50:48.539744000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_fwj1.table1' successfully created.\n"
[2025-04-25T20:50:48.539796000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T20:50:48.539804000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T20:50:50.894243000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_81g0g99au].\n"
[2025-04-25T20:50:50.894280000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:50:50.894288000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T20:50:53.318062000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_1vrwlq9ct].\n"
[2025-04-25T20:50:53.318098000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:50:53.318106000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T20:50:55.543545000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_cwxrpxpgx].\n"
[2025-04-25T20:50:55.543582000Z INFO cli::lib::pubsub] ""
[2025-04-25T20:50:55.543590000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T20:50:56.918268000Z ERROR cli::lib::gcs] "Creating gs://beaver_50jaajlvj/...\n"
[2025-04-25T20:50:56.918304000Z INFO cli::lib::gcs] ""
[2025-04-25T20:50:56.918315000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T20:50:56.919032000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T20:51:18.046742000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745614258.09639-81819c881dca4cccb1e2d2afc2b1118f.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/3502c9ba-d52e-4a2e-a9e1-5f9207cb75b7].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/3502c9ba-d52e-4a2e-a9e1-5f9207cb75b7?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T20:51:18.046778000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"3502c9ba-d52e-4a2e-a9e1-5f9207cb75b7\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745614258.09639-81819c881dca4cccb1e2d2afc2b1118f.tgz#1745614258677818\nCopying gs://neon-circle-400322_cloudbuild/source/1745614258.09639-81819c881dca4cccb1e2d2afc2b1118f.tgz#1745614258677818...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.                                      \nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 4b0b73e6c1ea\nRemoving intermediate container 4b0b73e6c1ea\n ---> a296d6629f12\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> d70aacf3195b\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 3c3a8cf0fba0\nRemoving intermediate container 3c3a8cf0fba0\n ---> 0a671ebb6504\nSuccessfully built 0a671ebb6504\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-yhpbqyq:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-yhpbqyq\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-yhpbqyq]\n20d9f79f3bf7: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\ncfe369838527: Layer already exists\n12979aa71141: Layer already exists\n310062f15e93: Layer already exists\n5f70bf18a086: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\n20d9f79f3bf7: Pushed\nlatest: digest: sha256:561ace38fb738c550985fc13dee092e7c425636435015bb34e85b76f9b8c014d size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                           IMAGES                                                                                                         STATUS\n3502c9ba-d52e-4a2e-a9e1-5f9207cb75b7  2025-04-25T20:50:58+00:00  16S       gs://neon-circle-400322_cloudbuild/source/1745614258.09639-81819c881dca4cccb1e2d2afc2b1118f.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-yhpbqyq (+1 more)  SUCCESS\n"
[2025-04-25T20:51:18.046799000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T20:51:18.046804000Z INFO cli::lib::crs] creating vector...
[2025-04-25T20:51:32.711587000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-nkso\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision..............................................................................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-nkso\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-nkso-00001-29t\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-nkso-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T20:51:32.711630000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T20:51:33.155086000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T20:51:33.155112000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T20:51:33.155117000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T20:51:36.969866000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_50jaajlvj/staging/beamapp-dmitriyivkov-0425205134-858669-8jjefds5.1745614294.858793/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_50jaajlvj/staging/beamapp-dmitriyivkov-0425205134-858669-8jjefds5.1745614294.858793/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_50jaajlvj/staging/beamapp-dmitriyivkov-0425205134-858669-8jjefds5.1745614294.858793/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_50jaajlvj/staging/beamapp-dmitriyivkov-0425205134-858669-8jjefds5.1745614294.858793/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_50jaajlvj/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_50jaajlvj/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_50jaajlvj/templates/beaver-detection-template

[2025-04-25T20:51:36.969908000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:61
[2025-04-25T20:51:36.969915000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T20:51:38.740469000Z INFO cli::lib::utilities] "createTime: '2025-04-25T20:51:38.727089Z'\ncurrentStateTime: '1970-01-01T00:00:00Z'\nid: 2025-04-25_13_51_38-9666244580539425218\nlocation: northamerica-northeast1\nname: beaver-detections\nprojectId: neon-circle-400322\nstartTime: '2025-04-25T20:51:38.727089Z'\ntype: JOB_TYPE_STREAMING\n"
[2025-04-25T20:51:38.740537000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T21:09:28.437833000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T21:09:29.476185000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T21:09:29.634514000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T21:09:29.634605000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T21:09:29.640117000Z INFO cli::lib::bq] creating bq...
[2025-04-25T21:09:31.874638000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_6gly' successfully created.\n"
[2025-04-25T21:09:33.996948000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_6gly.table1' successfully created.\n"
[2025-04-25T21:09:33.996979000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T21:09:33.996986000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T21:09:36.955244000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_ld23nplrb].\n"
[2025-04-25T21:09:36.955289000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:09:36.955299000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T21:09:39.330776000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_5yyi2w99k].\n"
[2025-04-25T21:09:39.330810000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:09:39.330818000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T21:09:42.449426000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_ibcooxjid].\n"
[2025-04-25T21:09:42.449470000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:09:42.449480000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T21:09:43.541070000Z ERROR cli::lib::gcs] "Creating gs://beaver_v9mc2btpa/...\n"
[2025-04-25T21:09:43.541121000Z INFO cli::lib::gcs] ""
[2025-04-25T21:09:43.541137000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T21:09:43.541832000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T21:10:04.483196000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3.0 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745615384.697912-23dadacb7de8464083a6344d62cc043f.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/8d9cac50-cc78-46bc-898a-ac7c476ccaec].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/8d9cac50-cc78-46bc-898a-ac7c476ccaec?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T21:10:04.483239000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"8d9cac50-cc78-46bc-898a-ac7c476ccaec\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745615384.697912-23dadacb7de8464083a6344d62cc043f.tgz#1745615385254324\nCopying gs://neon-circle-400322_cloudbuild/source/1745615384.697912-23dadacb7de8464083a6344d62cc043f.tgz#1745615385254324...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\nf7c2963674a5: Pull complete\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in fb59431cfc9f\nRemoving intermediate container fb59431cfc9f\n ---> de4d12bfa6fb\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 7eb2fd21ea15\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in e1d7bfb2d40e\nRemoving intermediate container e1d7bfb2d40e\n ---> 4769adff4560\nSuccessfully built 4769adff4560\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-oynigp1:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-oynigp1\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-oynigp1]\n03d1042deef8: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n310062f15e93: Layer already exists\n12979aa71141: Layer already exists\ncfe369838527: Layer already exists\n5f70bf18a086: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\n03d1042deef8: Pushed\nlatest: digest: sha256:31d383869689e49b4aea9b826ddc4a84d82dd9e310879f2e8bcdc94cab063c5c size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n8d9cac50-cc78-46bc-898a-ac7c476ccaec  2025-04-25T21:09:45+00:00  14S       gs://neon-circle-400322_cloudbuild/source/1745615384.697912-23dadacb7de8464083a6344d62cc043f.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-oynigp1 (+1 more)  SUCCESS\n"
[2025-04-25T21:10:04.483257000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T21:10:04.483263000Z INFO cli::lib::crs] creating vector...
[2025-04-25T21:10:12.834905000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-vddm\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision.................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-vddm\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-vddm-00001-5tg\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-vddm-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T21:10:12.834965000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T21:10:13.323249000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T21:10:13.323289000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T21:10:13.323295000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T21:10:17.351706000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_v9mc2btpa/staging/beamapp-dmitriyivkov-0425211015-230624-b8bsluqm.1745615415.230740/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_v9mc2btpa/staging/beamapp-dmitriyivkov-0425211015-230624-b8bsluqm.1745615415.230740/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_v9mc2btpa/staging/beamapp-dmitriyivkov-0425211015-230624-b8bsluqm.1745615415.230740/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_v9mc2btpa/staging/beamapp-dmitriyivkov-0425211015-230624-b8bsluqm.1745615415.230740/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_v9mc2btpa/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_v9mc2btpa/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_v9mc2btpa/templates/beaver-detection-template

[2025-04-25T21:10:17.351755000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:61
[2025-04-25T21:10:17.351762000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T21:10:18.571454000Z INFO cli::lib::utilities] "createTime: '2025-04-25T21:10:18.454660Z'\ncurrentStateTime: '1970-01-01T00:00:00Z'\nid: 2025-04-25_14_10_18-9563048881614819760\nlocation: northamerica-northeast1\nname: beaver-detections\nprojectId: neon-circle-400322\nstartTime: '2025-04-25T21:10:18.454660Z'\ntype: JOB_TYPE_STREAMING\n"
[2025-04-25T21:10:18.571497000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T21:29:48.187040000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T21:29:49.453846000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T21:29:49.622690000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T21:29:49.622788000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T21:29:49.628458000Z INFO cli::lib::bq] creating bq...
[2025-04-25T21:29:51.451522000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_fd0s' successfully created.\n"
[2025-04-25T21:29:53.436212000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_fd0s.table1' successfully created.\n"
[2025-04-25T21:29:53.436253000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T21:29:53.436259000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T21:29:55.682773000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_knxuobhkt].\n"
[2025-04-25T21:29:55.682822000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:29:55.682830000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T21:29:58.415018000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_3zgqr1s7c].\n"
[2025-04-25T21:29:58.415063000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:29:58.415071000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T21:30:00.838373000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_iipa5irvc].\n"
[2025-04-25T21:30:00.838414000Z INFO cli::lib::pubsub] ""
[2025-04-25T21:30:00.838422000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T21:30:02.007894000Z ERROR cli::lib::gcs] "Creating gs://beaver_ywct1zdm9/...\n"
[2025-04-25T21:30:02.007940000Z INFO cli::lib::gcs] ""
[2025-04-25T21:30:02.007950000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T21:30:02.008706000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T21:30:28.835971000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745616603.080968-3617be3869a048f686831cdf232e2bf4.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/8862e441-5bde-42f5-9336-c8188529f36b].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/8862e441-5bde-42f5-9336-c8188529f36b?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T21:30:28.836020000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"8862e441-5bde-42f5-9336-c8188529f36b\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745616603.080968-3617be3869a048f686831cdf232e2bf4.tgz#1745616603700764\nCopying gs://neon-circle-400322_cloudbuild/source/1745616603.080968-3617be3869a048f686831cdf232e2bf4.tgz#1745616603700764...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Verifying Checksum\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in 00875477c293\nRemoving intermediate container 00875477c293\n ---> 690544bea526\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 68317835d230\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in 9430b11190c7\nRemoving intermediate container 9430b11190c7\n ---> 36025def2d5e\nSuccessfully built 36025def2d5e\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-efuotr7:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-efuotr7\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-efuotr7]\n053ebe22445e: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n5f70bf18a086: Layer already exists\ncfe369838527: Layer already exists\n12979aa71141: Layer already exists\n310062f15e93: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\n053ebe22445e: Pushed\nlatest: digest: sha256:1a519992b22588d976756d2cc57c13192ec360a26507515475d4fa7ecfaf463e size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n8862e441-5bde-42f5-9336-c8188529f36b  2025-04-25T21:30:03+00:00  20S       gs://neon-circle-400322_cloudbuild/source/1745616603.080968-3617be3869a048f686831cdf232e2bf4.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-efuotr7 (+1 more)  SUCCESS\n"
[2025-04-25T21:30:28.836040000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T21:30:28.836045000Z INFO cli::lib::crs] creating vector...
[2025-04-25T21:30:43.492992000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-crsb\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision..............................................................................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-crsb\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-crsb-00001-2qg\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-crsb-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T21:30:43.493031000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T21:30:43.923408000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T21:30:43.923440000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T21:30:43.923446000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T21:30:48.177195000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_ywct1zdm9/staging/beamapp-dmitriyivkov-0425213045-642460-nyukkxmb.1745616645.642561/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_ywct1zdm9/staging/beamapp-dmitriyivkov-0425213045-642460-nyukkxmb.1745616645.642561/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_ywct1zdm9/staging/beamapp-dmitriyivkov-0425213045-642460-nyukkxmb.1745616645.642561/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_ywct1zdm9/staging/beamapp-dmitriyivkov-0425213045-642460-nyukkxmb.1745616645.642561/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_ywct1zdm9/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_ywct1zdm9/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_ywct1zdm9/templates/beaver-detection-template

[2025-04-25T21:30:48.177229000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:61
[2025-04-25T21:30:48.177235000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T21:30:49.367285000Z ERROR cli::lib::utilities] "ERROR: (gcloud.dataflow.jobs.run) ALREADY_EXISTS: (eea991e981d0598b): The workflow could not be created. Causes: (39d89a70ec9cddcd): There is already an active job named beaver-detections. If you want to submit a second job, try again by setting a different name.\n"
[2025-04-25T21:30:49.367324000Z INFO cli::lib::resources] serializing resources...
[2025-04-25T22:14:09.196528000Z INFO cli::commands::deploy] =======New Deployment======
[2025-04-25T22:14:10.554507000Z INFO cli::lib::sigma] converting sigma detections...
[2025-04-25T22:14:10.711634000Z INFO cli::lib::sigma] Generated a direction directory at /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/output/gcp_access_policy_deleted
[2025-04-25T22:14:10.711737000Z INFO cli::lib::detections_gen] generating aggregated detections...
[2025-04-25T22:14:10.717511000Z INFO cli::lib::bq] creating bq...
[2025-04-25T22:14:12.880783000Z INFO cli::lib::bq] "Dataset 'neon-circle-400322:beaver_datalake_bydd' successfully created.\n"
[2025-04-25T22:14:14.687311000Z INFO cli::lib::bq] "Table 'neon-circle-400322:beaver_datalake_bydd.table1' successfully created.\n"
[2025-04-25T22:14:14.687357000Z INFO cli::lib::pubsub] creating pubsub...
[2025-04-25T22:14:14.687365000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:166
[2025-04-25T22:14:16.966387000Z ERROR cli::lib::pubsub] "Created topic [projects/neon-circle-400322/topics/beaver_qahfk2mah].\n"
[2025-04-25T22:14:16.966418000Z INFO cli::lib::pubsub] ""
[2025-04-25T22:14:16.966426000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:106
[2025-04-25T22:14:20.151668000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_cmteq7keb].\n"
[2025-04-25T22:14:20.151718000Z INFO cli::lib::pubsub] ""
[2025-04-25T22:14:20.151727000Z INFO cli::lib::pubsub] function fn() called at src/lib/pubsub.rs:59
[2025-04-25T22:14:22.878322000Z ERROR cli::lib::pubsub] "Created subscription [projects/neon-circle-400322/subscriptions/beaver_zomsvudmf].\n"
[2025-04-25T22:14:22.878388000Z INFO cli::lib::pubsub] ""
[2025-04-25T22:14:22.878402000Z INFO cli::lib::gcs] creating bucket...
[2025-04-25T22:14:24.134847000Z ERROR cli::lib::gcs] "Creating gs://beaver_kxqah5yya/...\n"
[2025-04-25T22:14:24.134886000Z INFO cli::lib::gcs] ""
[2025-04-25T22:14:24.134899000Z INFO cli::lib::utilities] generating vector config...
[2025-04-25T22:14:24.135700000Z INFO cli::lib::cloud_build] Building Docker image via Cloud Build and saving to Artifact Registry...
[2025-04-25T22:14:47.163297000Z ERROR cli::lib::cloud_build] "Creating temporary archive of 4 file(s) totalling 3 KiB before compression.\nUploading tarball of [src/conf/artifacts] to [gs://neon-circle-400322_cloudbuild/source/1745619265.253802-1eb802e212b34609b8c7e8a7b98d280b.tgz]\nCreated [https://cloudbuild.googleapis.com/v1/projects/neon-circle-400322/locations/global/builds/14f87988-cd68-44c0-b1e8-717889a4e737].\nLogs are available at [ https://console.cloud.google.com/cloud-build/builds/14f87988-cd68-44c0-b1e8-717889a4e737?project=1054091574678 ].\nWaiting for build to complete. Polling interval: 1 second(s).\n"
[2025-04-25T22:14:47.163386000Z INFO cli::lib::cloud_build] "---------------------------------------------- REMOTE BUILD OUTPUT ----------------------------------------------\nstarting build \"14f87988-cd68-44c0-b1e8-717889a4e737\"\n\nFETCHSOURCE\nFetching storage object: gs://neon-circle-400322_cloudbuild/source/1745619265.253802-1eb802e212b34609b8c7e8a7b98d280b.tgz#1745619265798319\nCopying gs://neon-circle-400322_cloudbuild/source/1745619265.253802-1eb802e212b34609b8c7e8a7b98d280b.tgz#1745619265798319...\n/ [0 files][    0.0 B/  1.6 KiB]                                                \r/ [1 files][  1.6 KiB/  1.6 KiB]                                                \r\nOperation completed over 1 objects/1.6 KiB.\nBUILD\nAlready have image (with digest): gcr.io/cloud-builders/docker\nSending build context to Docker daemon  7.168kB\r\r\nStep 1/4 : FROM timberio/vector:latest-alpine\nlatest-alpine: Pulling from timberio/vector\nf18232174bc9: Already exists\nf7c2963674a5: Pulling fs layer\n3cb3048739a6: Pulling fs layer\n4cb0684866e6: Pulling fs layer\n0dfffc539448: Pulling fs layer\n4f4fb700ef54: Pulling fs layer\n0dfffc539448: Waiting\n4f4fb700ef54: Waiting\n4cb0684866e6: Download complete\nf7c2963674a5: Verifying Checksum\nf7c2963674a5: Download complete\n4f4fb700ef54: Verifying Checksum\n4f4fb700ef54: Download complete\n0dfffc539448: Verifying Checksum\n0dfffc539448: Download complete\nf7c2963674a5: Pull complete\n3cb3048739a6: Verifying Checksum\n3cb3048739a6: Download complete\n3cb3048739a6: Pull complete\n4cb0684866e6: Pull complete\n0dfffc539448: Pull complete\n4f4fb700ef54: Pull complete\nDigest: sha256:7ffb852df0243342ec9fc3d962905e9b9970ab69e942ee7652265e9c64974252\nStatus: Downloaded newer image for timberio/vector:latest-alpine\n ---> 43ef3b920c76\nStep 2/4 : EXPOSE 8080\n ---> Running in f0cdef508191\nRemoving intermediate container f0cdef508191\n ---> 11f4b2277cb1\nStep 3/4 : COPY \"vector.yaml\" \"vector.yaml\"\n ---> 37af36c9d35e\nStep 4/4 : CMD [\"--config-yaml\", \"vector.yaml\"]\n ---> Running in d8ef7368a309\nRemoving intermediate container d8ef7368a309\n ---> 8b916de9fb99\nSuccessfully built 8b916de9fb99\nSuccessfully tagged northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ijqpma4:latest\nPUSH\nPushing northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ijqpma4\nThe push refers to repository [northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ijqpma4]\n4967b1a715dc: Preparing\n5f70bf18a086: Preparing\n310062f15e93: Preparing\n12979aa71141: Preparing\ncfe369838527: Preparing\n59a81ac6038d: Preparing\n08000c18d16d: Preparing\n59a81ac6038d: Waiting\n08000c18d16d: Waiting\n310062f15e93: Layer already exists\n12979aa71141: Layer already exists\n5f70bf18a086: Layer already exists\ncfe369838527: Layer already exists\n59a81ac6038d: Layer already exists\n08000c18d16d: Layer already exists\n4967b1a715dc: Pushed\nlatest: digest: sha256:93e08e114fe70a164f32255ac3c39a5328394de9c8594ec5052eab9e3f23aaad size: 1777\nDONE\n-----------------------------------------------------------------------------------------------------------------\nID                                    CREATE_TIME                DURATION  SOURCE                                                                                            IMAGES                                                                                                         STATUS\n14f87988-cd68-44c0-b1e8-717889a4e737  2025-04-25T22:14:26+00:00  17S       gs://neon-circle-400322_cloudbuild/source/1745619265.253802-1eb802e212b34609b8c7e8a7b98d280b.tgz  northamerica-northeast1-docker.pkg.dev/neon-circle-400322/beaver-images/beaver-vector-image-ijqpma4 (+1 more)  SUCCESS\n"
[2025-04-25T22:14:47.163414000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:13
[2025-04-25T22:14:47.163421000Z INFO cli::lib::crs] creating vector...
[2025-04-25T22:14:55.951454000Z ERROR cli::lib::utilities] "Deploying container to Cloud Run service [\u{1b}[1mbeaver-vector-instance-9ieb\u{1b}[m] in project [\u{1b}[1mneon-circle-400322\u{1b}[m] region [\u{1b}[1mnorthamerica-northeast1\u{1b}[m]\nDeploying new service...\nCreating Revision......................................................................done\nRouting traffic.....done\nDone.\nService [\u{1b}[1mbeaver-vector-instance-9ieb\u{1b}[m] revision [\u{1b}[1mbeaver-vector-instance-9ieb-00001-8fx\u{1b}[m] has been deployed and is serving \u{1b}[1m100\u{1b}[m percent of traffic.\nService URL: \u{1b}[1mhttps://beaver-vector-instance-9ieb-1054091574678.northamerica-northeast1.run.app\u{1b}[m\n"
[2025-04-25T22:14:55.951505000Z INFO cli::lib::crs] function fn() called at src/lib/crs.rs:56
[2025-04-25T22:14:56.410553000Z ERROR cli::lib::utilities] "ERROR: (gcloud.beta.run.services.update) You must specify a region. Either use the `--region` flag or set the run/region property.\n"
[2025-04-25T22:14:56.410587000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:14
[2025-04-25T22:14:56.410594000Z INFO cli::lib::dataflow] creating template...
[2025-04-25T22:15:00.324574000Z WARN cli::lib::dataflow] /Users/dmitriyivkov/IdeaProjects/Beaver/src/conf/detections/venv/lib/python3.10/site-packages/google/auth/_default.py:76: UserWarning: Your application has authenticated using end user credentials from Google Cloud SDK without a quota project. You might receive a "quota exceeded" or "API not enabled" error. See the following page for troubleshooting: https://cloud.google.com/docs/authentication/adc-troubleshooting/user-creds. 
  warnings.warn(_CLOUD_SDK_CREDENTIALS_WARNING)
WARNING:google.auth._default:No project ID could be determined. Consider running `gcloud config set project` or setting the GOOGLE_CLOUD_PROJECT environment variable
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.typehints.native_type_compatibility:Converting string literal type hint to Any: "PubsubMessage"
WARNING:apache_beam.options.pipeline_options:Bucket specified in temp_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
WARNING:apache_beam.options.pipeline_options:Bucket specified in staging_location has soft-delete policy enabled. To avoid being billed for unnecessary storage costs, turn off the soft delete feature on buckets that your Dataflow jobs use for temporary and staging storage. For more information, see https://cloud.google.com/storage/docs/use-soft-delete#remove-soft-delete-policy.
INFO:apache_beam.runners.dataflow.dataflow_runner:Pipeline has additional dependencies to be installed in SDK worker container, consider using the SDK container image pre-building workflow to avoid repetitive installations. Learn more on https://cloud.google.com/dataflow/docs/guides/using-custom-containers#prebuild
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_kxqah5yya/staging/beamapp-dmitriyivkov-0425221458-181429-9p9kur1q.1745619298.181545/submission_environment_dependencies.txt...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_kxqah5yya/staging/beamapp-dmitriyivkov-0425221458-181429-9p9kur1q.1745619298.181545/submission_environment_dependencies.txt in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_kxqah5yya/staging/beamapp-dmitriyivkov-0425221458-181429-9p9kur1q.1745619298.181545/pipeline.pb...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_kxqah5yya/staging/beamapp-dmitriyivkov-0425221458-181429-9p9kur1q.1745619298.181545/pipeline.pb in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:Starting GCS upload to gs://beaver_kxqah5yya/templates/beaver-detection-template...
INFO:apache_beam.runners.dataflow.internal.apiclient:Completed GCS upload to gs://beaver_kxqah5yya/templates/beaver-detection-template in 0 seconds.
INFO:apache_beam.runners.dataflow.internal.apiclient:A template was just created at location gs://beaver_kxqah5yya/templates/beaver-detection-template

[2025-04-25T22:15:00.324614000Z INFO cli::lib::dataflow] function fn() called at src/lib/dataflow.rs:61
[2025-04-25T22:15:00.324627000Z INFO cli::lib::dataflow] executing dataflow template...
[2025-04-25T22:15:01.679208000Z INFO cli::lib::utilities] "createTime: '2025-04-25T22:15:01.564997Z'\ncurrentStateTime: '1970-01-01T00:00:00Z'\nid: 2025-04-25_15_15_01-8202367452081013488\nlocation: northamerica-northeast1\nname: beaver-detections\nprojectId: neon-circle-400322\nstartTime: '2025-04-25T22:15:01.564997Z'\ntype: JOB_TYPE_STREAMING\n"
[2025-04-25T22:15:01.679249000Z INFO cli::lib::resources] serializing resources...
